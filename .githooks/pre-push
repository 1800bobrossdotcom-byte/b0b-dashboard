#!/bin/sh
# B0B Pre-Push Quality Gate
# Runs build check before allowing push to origin

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "  B0B PRE-PUSH QUALITY GATE"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Check if dashboard has changes
if git diff --cached --name-only | grep -q "^dashboard/"; then
  echo "ğŸ“¦ Dashboard changes detected - running build check..."
  
  cd dashboard
  
  # Run build
  npm run build
  
  if [ $? -ne 0 ]; then
    echo ""
    echo "âŒ BUILD FAILED - Push blocked"
    echo "Fix the build errors before pushing."
    exit 1
  fi
  
  echo "âœ… Dashboard build passed"
  cd ..
fi

echo ""
echo "âœ… All quality gates passed - pushing..."
exit 0
